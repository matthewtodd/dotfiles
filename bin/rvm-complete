#!/usr/bin/env ruby

# Simple completion for rvm.
#
# ONLY provides help for switching to a different ruby/gemset, as in:
#   rvm ruby-1.8.7-p249
#   rvm ruby-1.8.7-p249%project
#
# Note, does not help with aliasing, so `rvm 1.8<tab>` won't (yet) work.
#
# Use in your .bashrc like so:
#   complete -C 'rvm-complete' rvm
#
choices = []
choices += Dir.entries(ENV['rvm_gems_path']) - ['.', '..', 'cache']
choices += ['default', 'system']

completion_after_the_first_word = ENV['COMP_LINE'].sub(/^\S*\s+/, '')

puts choices.grep(/^#{completion_after_the_first_word}/)
