#!/bin/sh

# This script fetches the PR URLs for any Github review request notifications
# received since the unix time SINCE environment variable (default 0).
#
# https://docs.github.com/en/rest/reference/activity#list-notifications-for-the-authenticated-user

set -euo pipefail

gh api /notifications?since=$(date -r${SINCE:-0} -Iseconds) \
  --cache=1h \
  --jq='.[] | select(.reason == "review_requested") | .subject.url'
